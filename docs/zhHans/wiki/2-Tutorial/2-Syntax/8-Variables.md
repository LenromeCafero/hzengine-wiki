# 变量

当你想实现好感度，或者金钱系统之类时，经常需要存储一些数值，并对这些数值进行一些运算。此时我们的 变量 就登场了。

学习变量的使用，我们建议你有一定的编程基础，这样理解起来会快很多。

变量用来保存一个值。这个值可以是一个数字、一个字符串、一个布尔值（真或假）、一个 JSON 数组或对象。

你可以把变量设想成一个箱子，这个箱子里存放了你想放的值。随时可以拿出来，随时可以把里面的东西换成新的。

在 HZengine 中，变量有 全局变量 和 存档变量 两种。全局变量将随着整个游戏一起保存，哪怕你删除了当前的存档。而存档变量保存在存档中，不同的存档的变量可能不同。

全局变量以 `gd` 开头，存档变量以 `sd` 开头。

那么，如何创建一个变量？

## $ 语句

::: tip 提示
目前 $ 语句的底层实际是 eval 语句。eval 直接动态执行 JavaScript 语句，存在一定的安全隐患。未来 $ 语句使用独立的表达式求值和变量操作引擎，与 JavaScript 环境隔绝，所以优先使用 $ 而不是 eval。
:::

这个语句可以执行对变量的操作，我们叫它变量操作语句。

### 创建一个变量

此处以存档变量为例。创建，或者叫声明一个存档变量，你只需

```renpy
$ sd.<变量名> = <初始值/表达式>
```

例如我们想创建一个变量用来保存主角的金钱，可以这样

```renpy
$ sd.money = 100
```

这样就创建了一个变量 `sd.money` ，它的初始值是 100.

如果你想创建一个全局变量，把 sd 换成 gd 即可。

变量名的命名有特殊要求，它必须以字母或者下划线开头，而不能以数字开头（这里其实就是 JavaScript 的标识符规范，为了便于没有 JS 基础的初学者理解，这里就缩紧了一下规则）

#### 值的类型

* 数字：可以是整数或者浮点数（小数）。例如 `100` ，`9.8` ，周围不加引号。当你想表示一个小数的时候，如果整数部分是 0，你可以直接省略 0，比如 `0.3` -> `.3` 。
* 字符串：由英文双引号包裹的一串文字。例如\
  `"这是一个字符串 哈哈"` 。如果你想让字符串中包含换行或者引号，请搜索字符串转义。
* 布尔值：布尔值表示判断，只有两个值，`true` （真）或者 `false` （假）。
* 空值：`null` 表示空值，表示这个变量不包含东西。
* JSON 数组或对象：可以保存一个包含多个值的列表（数组），或者多个值的对象。JSON 语法较为复杂，在此教程中暂不介绍，有需要请自行搜索。

至于表达式，可以看稍后的介绍。

### 修改一个变量

修改变量和创建变量的语法一模一样。

此处以存档变量为例。修改一个存档变量，你只需

```renpy
$ sd.<变量名> = <初始值/表达式>
```

这也叫做 **赋值语句** 。

```renpy
$ sd.money = 100
```

这个语句的作用是 “把 100 赋值给 sd.money 变量”

### 删除一个变量

删除变量需要用到 delete 关键字。用法为

```renpy
$ delete sd.<要删除的变量名>
```

例如

```renpy
$ delete sd.money
```

就可以删除刚才创建的变量。

## 表达式

在 HZengine Script 中，你可以使用表达式来对变量进行运算。表达式类似一个算式，有明确的计算结果。表达式可以用于赋值、文字插值、条件判断等操作。

此部分暂时懒得写。如果你会 JavaScript 应该就知道咋用，因为这实际上就是 JavaScript 表达式。QAQ

### 字符串插值

你可以在字符串中插入一个表达式的值，在字符串中，英文方括号 `[]` 被用于插入表达式。

例如

```renpy
$ sd.money = 100
"银行员工" "现在你有[sd.money]块钱"
```

这样， HZengine 会先计算 `sd.money` 的值，然后再将结果插入到字符串中。

屏幕上显示的结果将会是 “现在你有100块钱”

目前支持字符串插值的地方有：

* say 语句的独白或对话文字（角色名字还不行（其实多敲两行代码就行了但不知道为啥当时没写））；
* menu 语句的 @ 命令中的按钮文字；
* character 语句中角色的显示名字。

如果你不想使用字符串插值，而是在屏幕上显示英文方括号，请使用连续两个方括号来表示转义。

例如

```renpy
$ sd.money = 100
"银行员工" "现在你有[[sd.money]]块钱"
```

屏幕上显示的结果将会是 “现在你有\[sd.money]块钱”



在下一章《循环与条件判断》中，你可以学习如何使用变量的知识来做出条件判断、条件循环。
